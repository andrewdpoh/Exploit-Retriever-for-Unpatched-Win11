# Exploit Retriever for Unpatched Win11
## Description
This tool can retrieve exploits for unpatched versions of Windows 11 machines from Exploit-DB and Github based on the version.  
The 2 scripts (exploit_retriever.py and exploit_retriever_WESNG.py) both have the same goal but work differently  

I originally worked on exploit_retriever_WESNG.py and based this project around WES-NG. However, I found that it was quite limited in ability (using missingkbs.exe requires admin privilege, which defeats the purpose of scanning if the goal is privilege escalation | using systeminfo would provide very few CVEs as it does not take into account the Windows update version).  

Hence, I created exploit_retriever.py and tried my own method of enumeration (see exploit_retriever.py step 1) which was specific to the version of the target Windows machine (down to the update!). This allowed for more CVE results for outdated versions of Windows.  

exploit_retriever_WESNG.py also lacks error handling and github searching as I focused my attention on exploit_retriever.py after I realised the limitations of WES-NG. I am only keeping the script here in case I wish to improve on it in the future.  

I would suggest using exploit_retriever.py over exploit_retriever_WESNG.py :D  

## Usage
### exploit_retriever.py
1. In the target machine's command prompt, run the following:  
    a. `ver > sysinfo.txt & echo %PROCESSOR_ARCHITECTURE% >> sysinfo.txt`
4. Move the resultant sysinfo.txt file into the same directory as exploit_retriever.py
5. Run `py exploit_retriever.py`

### exploit_retriever_WESNG.py
1. In the target machine's command prompt:  
    a. run `missingkbs.vbs` (from the wesng folder)  
    b. run `systeminfo.exe > systeminfo.txt`
2. Move the resultant a. missing.txt / b. systeminfo.txt into the wesng directory
3. Change directory into the wesng directory and run the relevant command:  
    a. `py wes.py -m missing.txt -o vulnerabilities.csv`  
    b. `py wes.py systeminfo.txt -o vulneravilities.csv`
4. Run exploit_retriever_WESNG.py: py exploit_retriever_WESNG.py  
For more information on WES-NG, look here: https://github.com/bitsadmin/wesng 

### update_exploitDB.py:
1. `py update_exploitDB.py`  
This is to update the exploitDB.csv sheet which is used in exploit_retriever.py
