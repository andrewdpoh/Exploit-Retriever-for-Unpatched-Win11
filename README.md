# Exploit Retriever for Unpatched Win11
## Description
This tool can retrieve exploits for unpatched versions of Windows 11 machines from Exploit-DB and Github based on the Windows version.  

I originally based this project around the WES-NG tool. However, I found that it was quite limited in ability (using missingkbs.exe requires admin privilege, which defeats the purpose of scanning if the goal is privilege escalation | using systeminfo would provide very few CVEs as it does not take into account the Windows update version).  

Hence, I created exploit_retriever.py and tried my own method of enumeration (see exploit_retriever.py step 1) which was specific to the version of the target Windows machine. This allowed for more CVE results for outdated versions of Windows. The script initially automatically downloaded the exploits from online, but I realised that may be dangerous so I removed that capability.


## Usage
### exploit_retriever.py
1. In the target machine's command prompt, run the following:  
    a. `ver > sysinfo.txt & echo %PROCESSOR_ARCHITECTURE% >> sysinfo.txt`
4. Move the resultant sysinfo.txt file into the same directory as exploit_retriever.py (or just copy and paste the text)
5. Run `py exploit_retriever.py`

### update_exploitDB.py:
1. `py update_exploitDB.py`  
This is to update the exploitDB.csv sheet

## How it works
After getting sysinfo.txt (see Usage step 1.), the Python script does the following:
1. Formats information into its [Common Platform Enumeration (CPE)](https://nvd.nist.gov/products/cpe)
2. Queries the [National Vulnerability Database (NVD) API](https://nvd.nist.gov/developers/vulnerabilities) for CVEs based on the CPE
3. Uses the [PoC in Github](https://github.com/nomi-sec/PoC-in-GitHub) API to look for github exploits
4. Uses the [ExploitDB CSV](https://gitlab.com/exploit-database/exploitdb/-/raw/main/files_exploits.csv) to check for ExploitDB exploits